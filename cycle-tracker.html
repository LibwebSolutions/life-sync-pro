<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cycle Tracker - LifeSync Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        :root {
            --primary: #ff5a8c; /* Strawberry Pink */
            --primary-light: #ff8ab0;
            --secondary: #ff2e6d;
            --accent: #ff9ebf;
            --success: #4cc9f0;
            --warning: #ffb74d;
            --danger: #ff5252;
            --light: #fff5f8;
            --dark: #2c2c2c;
            --gray: #888888;
            --gray-light: #f0f0f0;
            --border-radius: 16px;
            --box-shadow: 0 6px 20px rgba(255, 90, 140, 0.15);
            --transition: all 0.3s ease;
        }

        body {
            background-color: #fffafc;
            color: var(--dark);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            background-image: radial-gradient(var(--primary-light) 1px, transparent 1px);
            background-size: 20px 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px 0;
            border-bottom: 2px solid rgba(255, 90, 140, 0.1);
            animation: fadeInDown 0.8s ease;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo h1 {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo p {
            color: var(--gray);
            font-size: 14px;
            margin-top: -5px;
        }

        .logo-icon {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            box-shadow: var(--box-shadow);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(255, 90, 140, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(255, 90, 140, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(255, 90, 140, 0);
            }
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-info span {
            font-weight: 500;
            color: var(--dark);
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 20px;
            box-shadow: var(--box-shadow);
        }

        main {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 30px;
            animation: fadeIn 1s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .sidebar {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 25px 20px;
            box-shadow: var(--box-shadow);
            height: fit-content;
            border: 1px solid rgba(255, 90, 140, 0.1);
            animation: slideInLeft 0.8s ease;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .sidebar h2 {
            font-size: 20px;
            margin-bottom: 25px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light);
        }

        .sidebar h2 i {
            color: var(--primary);
        }

        .sidebar ul {
            list-style: none;
        }

        .sidebar li {
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--gray);
            font-weight: 500;
            border: 2px solid transparent;
        }

        .sidebar li:hover {
            background-color: var(--light);
            color: var(--primary);
            transform: translateX(5px);
            border-color: rgba(255, 90, 140, 0.2);
        }

        .sidebar li.active {
            background: linear-gradient(135deg, rgba(255, 90, 140, 0.1), rgba(255, 142, 191, 0.1));
            color: var(--primary);
            border-color: var(--primary);
            font-weight: 600;
            animation: highlightPulse 2s infinite;
        }

        @keyframes highlightPulse {
            0% {
                box-shadow: 0 0 0 0 rgba(255, 90, 140, 0.2);
            }
            70% {
                box-shadow: 0 0 0 5px rgba(255, 90, 140, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(255, 90, 140, 0);
            }
        }

        .cycle-content {
            display: flex;
            flex-direction: column;
            gap: 30px;
            animation: slideInRight 0.8s ease;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .page-header {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--box-shadow);
            border: 1px solid rgba(255, 90, 140, 0.1);
            position: relative;
            overflow: hidden;
        }

        .page-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
        }

        .page-header h2 {
            font-size: 28px;
            margin-bottom: 8px;
            color: var(--dark);
        }

        .page-header p {
            color: var(--gray);
            margin-bottom: 20px;
        }

        .input-section {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--box-shadow);
            border: 1px solid rgba(255, 90, 140, 0.1);
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .input-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .section-header h3 {
            font-size: 22px;
            color: var(--dark);
            font-weight: 600;
            position: relative;
            display: inline-block;
        }

        .section-header h3::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), transparent);
            animation: underlineExpand 2s infinite alternate;
        }

        @keyframes underlineExpand {
            0% {
                width: 0%;
                left: 0;
            }
            50% {
                width: 100%;
                left: 0;
            }
            100% {
                width: 0%;
                left: 100%;
            }
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 15px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 4px 15px rgba(255, 90, 140, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 90, 140, 0.4);
        }

        .btn-outline {
            background-color: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-outline:hover {
            background-color: rgba(255, 90, 140, 0.1);
            transform: translateY(-3px);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
        }

        .form-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
            font-size: 16px;
        }

        .form-group label.required::after {
            content: " *";
            color: var(--danger);
        }

        .form-control {
            width: 100%;
            padding: 14px 16px;
            border-radius: 10px;
            border: 2px solid var(--gray-light);
            font-size: 16px;
            transition: var(--transition);
            background-color: white;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255, 90, 140, 0.1);
        }

        .form-control:disabled {
            background-color: var(--gray-light);
            cursor: not-allowed;
        }

        .form-hint {
            display: block;
            margin-top: 6px;
            font-size: 14px;
            color: var(--gray);
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
        }

        .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 10px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .radio-item input[type="radio"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
        }

        .input-with-icon {
            position: relative;
        }

        .input-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .cycle-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .cycle-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            border: 1px solid rgba(255, 90, 140, 0.1);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            animation: cardFloat 3s ease-in-out infinite;
            animation-delay: calc(var(--i) * 0.2s);
        }

        @keyframes cardFloat {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .cycle-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(180deg, var(--primary), var(--accent));
        }

        .cycle-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 25px rgba(255, 90, 140, 0.2);
        }

        .cycle-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .cycle-header i {
            font-size: 24px;
            color: var(--primary);
            background-color: rgba(255, 90, 140, 0.1);
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: iconSpin 5s linear infinite;
        }

        @keyframes iconSpin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        .cycle-value {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 5px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .cycle-label {
            color: var(--gray);
            font-size: 15px;
            margin-bottom: 15px;
        }

        .cycle-phase {
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            width: fit-content;
            animation: phaseGlow 2s infinite alternate;
        }

        @keyframes phaseGlow {
            from {
                box-shadow: 0 0 5px currentColor;
            }
            to {
                box-shadow: 0 0 15px currentColor;
            }
        }

        .phase-follicular {
            background-color: rgba(76, 201, 240, 0.15);
            color: #4cc9f0;
        }

        .phase-ovulation {
            background-color: rgba(255, 90, 140, 0.15);
            color: var(--primary);
        }

        .phase-luteal {
            background-color: rgba(255, 158, 191, 0.15);
            color: var(--accent);
        }

        .phase-menstrual {
            background-color: rgba(255, 82, 82, 0.15);
            color: var(--danger);
        }

        .cycle-visualization {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 992px) {
            .cycle-visualization {
                grid-template-columns: 1fr;
            }
        }

        .cycle-chart {
            height: 300px;
            position: relative;
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            padding: 20px;
            background: linear-gradient(135deg, rgba(255, 90, 140, 0.05), rgba(255, 142, 191, 0.05));
            border-radius: var(--border-radius);
        }

        .chart-day {
            width: 40px;
            background: linear-gradient(180deg, var(--primary-light), var(--primary));
            border-radius: 8px 8px 0 0;
            transition: var(--transition);
            position: relative;
            cursor: pointer;
            animation: chartGrow 1.5s ease-out;
            animation-fill-mode: both;
        }

        @keyframes chartGrow {
            from {
                height: 0;
            }
            to {
                height: var(--chart-height);
            }
        }

        .chart-day:hover {
            background: linear-gradient(180deg, var(--primary), var(--secondary));
            transform: scale(1.05);
        }

        .chart-day-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 13px;
            color: var(--gray);
            font-weight: 500;
        }

        .chart-day-today {
            animation: todayPulse 2s infinite;
        }

        @keyframes todayPulse {
            0% {
                box-shadow: 0 0 0 0 rgba(255, 90, 140, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(255, 90, 140, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(255, 90, 140, 0);
            }
        }

        .phase-indicator {
            display: flex;
            justify-content: space-around;
            margin-top: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .phase-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            border-radius: 12px;
            background-color: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: var(--transition);
        }

        .phase-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(255, 90, 140, 0.15);
        }

        .symptoms-section {
            margin-top: 30px;
        }

        .symptoms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .symptom-item {
            background-color: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border: 2px solid transparent;
            transition: var(--transition);
            text-align: center;
            cursor: pointer;
            animation: symptomAppear 0.5s ease-out;
            animation-fill-mode: both;
        }

        @keyframes symptomAppear {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .symptom-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(255, 90, 140, 0.15);
            border-color: var(--primary);
        }

        .symptom-item.active {
            background: linear-gradient(135deg, rgba(255, 90, 140, 0.1), rgba(255, 142, 191, 0.1));
            border-color: var(--primary);
            animation: symptomActive 1s infinite alternate;
        }

        @keyframes symptomActive {
            from {
                box-shadow: 0 0 5px rgba(255, 90, 140, 0.5);
            }
            to {
                box-shadow: 0 0 15px rgba(255, 90, 140, 0.8);
            }
        }

        .symptom-icon {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .symptom-name {
            font-weight: 600;
            font-size: 14px;
        }

        .prediction-section {
            background: linear-gradient(135deg, rgba(255, 90, 140, 0.1), rgba(255, 142, 191, 0.1));
            border-radius: var(--border-radius);
            padding: 30px;
            margin-top: 30px;
            position: relative;
            overflow: hidden;
        }

        .prediction-section::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 90, 140, 0.1) 0%, transparent 70%);
            animation: predictionBg 10s infinite linear;
        }

        @keyframes predictionBg {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        .prediction-content {
            position: relative;
            z-index: 1;
        }

        .prediction-date {
            font-size: 28px;
            font-weight: 700;
            margin: 15px 0;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: dateGlow 2s infinite alternate;
        }

        @keyframes dateGlow {
            from {
                text-shadow: 0 0 5px rgba(255, 90, 140, 0.5);
            }
            to {
                text-shadow: 0 0 15px rgba(255, 90, 140, 0.8);
            }
        }

        .data-controls {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 20px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(255, 90, 140, 0.3);
            z-index: 1000;
            font-weight: 500;
            animation: slideIn 0.3s ease, slideOut 0.3s ease 2.7s;
            border-left: 5px solid white;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        .floating-orb {
            position: fixed;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: radial-gradient(circle, var(--primary-light), transparent 70%);
            pointer-events: none;
            z-index: -1;
            animation: floatOrb 20s infinite linear;
        }

        @keyframes floatOrb {
            0% {
                transform: translate(0, 0) rotate(0deg);
                opacity: 0.3;
            }
            25% {
                transform: translate(100vw, 50vh) rotate(90deg);
                opacity: 0.5;
            }
            50% {
                transform: translate(50vw, 100vh) rotate(180deg);
                opacity: 0.3;
            }
            75% {
                transform: translate(0, 50vh) rotate(270deg);
                opacity: 0.5;
            }
            100% {
                transform: translate(0, 0) rotate(360deg);
                opacity: 0.3;
            }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 30px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: relative;
            animation: modalSlideIn 0.5s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            position: relative;
        }

        .step-indicator::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: var(--gray-light);
            z-index: 1;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
        }

        .step-circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray);
            font-weight: 600;
            margin-bottom: 8px;
            transition: var(--transition);
        }

        .step.active .step-circle {
            background-color: var(--primary);
            color: white;
            transform: scale(1.1);
        }

        .step.completed .step-circle {
            background-color: var(--success);
            color: white;
        }

        .step-label {
            font-size: 14px;
            color: var(--gray);
            text-align: center;
        }

        .step.active .step-label {
            color: var(--primary);
            font-weight: 600;
        }

        @media (max-width: 1100px) {
            main {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
                justify-content: center;
            }
            
            .sidebar h2 {
                width: 100%;
                text-align: center;
                justify-content: center;
            }
            
            .sidebar ul {
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                gap: 10px;
                width: 100%;
            }
            
            .sidebar li {
                margin-bottom: 0;
                flex: 1;
                min-width: 140px;
                justify-content: center;
                text-align: center;
            }
            
            .cycle-overview {
                grid-template-columns: 1fr;
            }
            
            .form-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .data-controls {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }
            
            .symptoms-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .step-indicator {
                flex-wrap: wrap;
                justify-content: center;
                gap: 20px;
            }
            
            .step-indicator::before {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Floating background orbs -->
    <div class="floating-orb" style="top: 10%; left: 5%; animation-delay: 0s;"></div>
    <div class="floating-orb" style="top: 60%; right: 10%; animation-delay: -5s; width: 150px; height: 150px;"></div>
    <div class="floating-orb" style="bottom: 20%; left: 15%; animation-delay: -10s; width: 80px; height: 80px;"></div>

    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-sync-alt"></i>
                </div>
                <div>
                    <h1>LifeSync Pro</h1>
                    <p>Your all-in-one planner</p>
                </div>
            </div>
            <div class="user-info">
                <span>Welcome back, <strong>Jane!</strong></span>
                <div class="user-avatar">J</div>
            </div>
        </header>

        <main>
            <nav class="sidebar">
                <h2><i class="fas fa-th-large"></i> Dashboard</h2>
                <ul>
                    <li><i class="fas fa-calendar-day"></i> <a href="index.html" style="text-decoration: none; color: inherit;">Daily Planner</a></li>
                    <li><i class="fas fa-wallet"></i> <a href="budget.html" style="text-decoration: none; color: inherit;">Budget</a></li>
                    <li class="active"><i class="fas fa-sync-alt"></i> <a href="cycle-tracker.html" style="text-decoration: none; color: inherit;">Cycle Tracker</a></li>
                    <li><i class="fas fa-baby"></i> <a href="pregnancy.html" style="text-decoration: none; color: inherit;">Pregnancy</a></li>
                    <li><i class="fas fa-utensils"></i> <a href="meal-planner.html" style="text-decoration: none; color: inherit;">Meal Planner</a></li>
                    <li><i class="fas fa-calendar-alt"></i> <a href="calendar.html" style="text-decoration: none; color: inherit;">Calendar</a></li>
                </ul>
            </nav>

            <div class="cycle-content">
                <section class="page-header">
                    <h2>Cycle Tracker</h2>
                    <p>Track your menstrual cycle by entering your information below. Accurate tracking helps predict your cycle and understand your body better.</p>
                    
                    <!-- Step Indicator -->
                    <div class="step-indicator">
                        <div class="step active" id="step1">
                            <div class="step-circle">1</div>
                            <div class="step-label">Basic Info</div>
                        </div>
                        <div class="step" id="step2">
                            <div class="step-circle">2</div>
                            <div class="step-label">Cycle Details</div>
                        </div>
                        <div class="step" id="step3">
                            <div class="step-circle">3</div>
                            <div class="step-label">Symptoms</div>
                        </div>
                        <div class="step" id="step4">
                            <div class="step-circle">4</div>
                            <div class="step-label">Overview</div>
                        </div>
                    </div>
                </section>

                <!-- Step 1: Basic Information -->
                <section class="input-section" id="step1-content">
                    <div class="section-header">
                        <h3>Basic Information</h3>
                    </div>
                    
                    <div class="form-container">
                        <div class="form-group">
                            <label for="user-age" class="required">Your Age</label>
                            <input type="number" id="user-age" class="form-control" min="13" max="60" placeholder="Enter your age">
                            <span class="form-hint">Age affects cycle regularity and predictions</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="cycle-start-date" class="required">Last Period Start Date</label>
                            <input type="date" id="cycle-start-date" class="form-control">
                            <span class="form-hint">The first day of your last menstrual period</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="period-length" class="required">Typical Period Length</label>
                            <div class="input-with-icon">
                                <input type="number" id="period-length" class="form-control" min="1" max="14" placeholder="e.g., 5">
                                <span class="input-icon">days</span>
                            </div>
                            <span class="form-hint">How many days does your period usually last?</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="cycle-length" class="required">Typical Cycle Length</label>
                            <div class="input-with-icon">
                                <input type="number" id="cycle-length" class="form-control" min="21" max="45" placeholder="e.g., 28">
                                <span class="input-icon">days</span>
                            </div>
                            <span class="form-hint">Days from the first day of one period to the first day of the next</span>
                        </div>
                    </div>
                    
                    <div class="data-controls">
                        <button class="btn btn-primary" id="next-to-step2">
                            Next: Cycle Details <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </section>

                <!-- Step 2: Cycle Details -->
                <section class="input-section" id="step2-content" style="display: none;">
                    <div class="section-header">
                        <h3>Cycle Details</h3>
                    </div>
                    
                    <div class="form-container">
                        <div class="form-group">
                            <label for="flow-intensity" class="required">Typical Flow Intensity</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" id="flow-light" name="flow-intensity" value="light">
                                    <label for="flow-light">Light</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="flow-medium" name="flow-intensity" value="medium" checked>
                                    <label for="flow-medium">Medium</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="flow-heavy" name="flow-intensity" value="heavy">
                                    <label for="flow-heavy">Heavy</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="contraception">Contraception Method</label>
                            <select id="contraception" class="form-control">
                                <option value="none">None</option>
                                <option value="pill">Birth Control Pill</option>
                                <option value="iud">IUD</option>
                                <option value="implant">Implant</option>
                                <option value="injection">Injection</option>
                                <option value="patch">Patch</option>
                                <option value="ring">Vaginal Ring</option>
                                <option value="barrier">Barrier Methods</option>
                                <option value="other">Other</option>
                            </select>
                            <span class="form-hint">Contraception can affect cycle regularity</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="pregnant-planning">Pregnancy Planning</label>
                            <select id="pregnant-planning" class="form-control">
                                <option value="not-planning">Not Planning Pregnancy</option>
                                <option value="planning">Planning Pregnancy</option>
                                <option value="trying">Trying to Conceive</option>
                                <option value="avoiding">Avoiding Pregnancy</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Cycle Regularity</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" id="regular-yes" name="regularity" value="regular" checked>
                                    <label for="regular-yes">Regular</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="regular-no" name="regularity" value="irregular">
                                    <label for="regular-no">Irregular</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="regular-unsure" name="regularity" value="unsure">
                                    <label for="regular-unsure">Not Sure</label>
                                </div>
                            </div>
                            <span class="form-hint">Regular cycles are typically 21-35 days with minimal variation</span>
                        </div>
                    </div>
                    
                    <div class="data-controls">
                        <button class="btn btn-outline" id="back-to-step1">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <button class="btn btn-primary" id="next-to-step3">
                            Next: Symptoms <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </section>

                <!-- Step 3: Symptoms Tracking -->
                <section class="input-section" id="step3-content" style="display: none;">
                    <div class="section-header">
                        <h3>Symptoms Tracking</h3>
                        <p class="form-hint">Select symptoms you commonly experience during your cycle</p>
                    </div>
                    
                    <div class="form-group">
                        <label>Common Menstrual Symptoms</label>
                        <div class="checkbox-group" id="symptoms-checklist">
                            <!-- Symptoms will be dynamically added here -->
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="additional-symptoms">Additional Symptoms (Optional)</label>
                        <textarea id="additional-symptoms" class="form-control" rows="3" placeholder="List any other symptoms you experience during your cycle..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="mood-tracking">Mood Tracking Preference</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="mood-daily" name="mood-tracking" value="daily" checked>
                                <label for="mood-daily">Track Daily</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="mood-cycle" name="mood-tracking" value="cycle">
                                <label for="mood-cycle">Track During Cycle Only</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="mood-none" name="mood-tracking" value="none">
                                <label for="mood-none">Don't Track Mood</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="data-controls">
                        <button class="btn btn-outline" id="back-to-step2">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <button class="btn btn-primary" id="next-to-step4">
                            Next: Overview <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </section>

                <!-- Step 4: Overview and Start Tracking -->
                <section class="input-section" id="step4-content" style="display: none;">
                    <div class="section-header">
                        <h3>Review & Start Tracking</h3>
                        <p class="form-hint">Review your information and start tracking your cycle</p>
                    </div>
                    
                    <div class="cycle-overview" id="review-summary">
                        <!-- Summary will be dynamically added here -->
                    </div>
                    
                    <div class="form-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="reminders" checked>
                            <label for="reminders">Send me reminders for period start, ovulation, and fertile window</label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="data-sharing" checked>
                            <label for="data-sharing">Allow anonymous data sharing to improve predictions (no personal information shared)</label>
                        </div>
                    </div>
                    
                    <div class="data-controls">
                        <button class="btn btn-outline" id="back-to-step3">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <button class="btn btn-primary" id="start-tracking">
                            <i class="fas fa-play-circle"></i> Start Tracking My Cycle
                        </button>
                    </div>
                </section>

                <!-- Cycle Overview (Visible after setup) -->
                <section class="page-header" id="cycle-overview-section" style="display: none;">
                    <h2>Your Cycle Overview</h2>
                    <p>Based on your information, here's your current cycle status and predictions.</p>
                    
                    <div class="cycle-overview">
                        <div class="cycle-card" style="--i: 0;">
                            <div class="cycle-header">
                                <h3>Current Day</h3>
                                <i class="fas fa-calendar-day"></i>
                            </div>
                            <div class="cycle-value" id="current-day">Day 1</div>
                            <div class="cycle-label" id="cycle-length-label">of 28-day cycle</div>
                            <div class="cycle-phase phase-menstrual" id="current-phase">Menstrual</div>
                        </div>

                        <div class="cycle-card" style="--i: 1;">
                            <div class="cycle-header">
                                <h3>Cycle Length</h3>
                                <i class="fas fa-ruler"></i>
                            </div>
                            <div class="cycle-value" id="cycle-length-value">28</div>
                            <div class="cycle-label">days average</div>
                            <div class="cycle-label">Next cycle starts in <span id="days-until-next">28 days</span></div>
                        </div>

                        <div class="cycle-card" style="--i: 2;">
                            <div class="cycle-header">
                                <h3>Fertility Window</h3>
                                <i class="fas fa-egg"></i>
                            </div>
                            <div class="cycle-value" id="fertility-status">Low</div>
                            <div class="cycle-label" id="fertility-dates">Calculating...</div>
                            <div class="cycle-phase phase-follicular">Not Fertile</div>
                        </div>

                        <div class="cycle-card" style="--i: 3;">
                            <div class="cycle-header">
                                <h3>Next Period</h3>
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <div class="cycle-value" id="next-period-date">Jan 28</div>
                            <div class="cycle-label">Predicted start date</div>
                            <div class="cycle-phase phase-menstrual">In 28 days</div>
                        </div>
                    </div>
                </section>

                <!-- Cycle Visualization (Visible after setup) -->
                <div class="cycle-visualization" id="cycle-visualization-section" style="display: none;">
                    <section class="input-section">
                        <div class="section-header">
                            <h3>Cycle Visualization</h3>
                            <button class="btn btn-outline btn-small" id="log-period-btn">Log Period Start</button>
                        </div>
                        
                        <div class="cycle-chart" id="cycle-chart">
                            <!-- Chart bars will be dynamically added here -->
                        </div>
                        
                        <div class="phase-indicator">
                            <div class="phase-item">
                                <div class="phase-color" style="background-color: #ff5252;"></div>
                                <span>Menstrual Phase</span>
                            </div>
                            <div class="phase-item">
                                <div class="phase-color" style="background-color: #4cc9f0;"></div>
                                <span>Follicular Phase</span>
                            </div>
                            <div class="phase-item">
                                <div class="phase-color" style="background-color: #ff5a8c;"></div>
                                <span>Ovulation</span>
                            </div>
                            <div class="phase-item">
                                <div class="phase-color" style="background-color: #ff9ebf;"></div>
                                <span>Luteal Phase</span>
                            </div>
                        </div>
                    </section>

                    <section class="input-section">
                        <div class="section-header">
                            <h3>Today's Symptoms</h3>
                            <button class="btn btn-outline btn-small" id="add-symptom-btn">Add Symptom</button>
                        </div>
                        
                        <div class="symptoms-grid" id="symptoms-grid">
                            <!-- Symptoms will be dynamically added here -->
                        </div>
                        
                        <div class="symptoms-section">
                            <div class="section-header">
                                <h3>Mood & Energy</h3>
                                <button class="btn btn-outline btn-small" id="add-mood-btn">Add Mood</button>
                            </div>
                            <div class="symptoms-grid" id="mood-grid">
                                <!-- Mood items will be dynamically added here -->
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Daily Log Section (Visible after setup) -->
                <section class="input-section" id="daily-log-section" style="display: none;">
                    <div class="section-header">
                        <h3>Daily Log</h3>
                        <div class="cycle-label" id="today-date">Today: December 16, 2025</div>
                    </div>
                    
                    <div class="form-container">
                        <div class="form-group">
                            <label for="daily-flow">Flow Today</label>
                            <select id="daily-flow" class="form-control">
                                <option value="none">No Flow</option>
                                <option value="spotting">Spotting</option>
                                <option value="light">Light</option>
                                <option value="medium">Medium</option>
                                <option value="heavy">Heavy</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="daily-energy">Energy Level</label>
                            <select id="daily-energy" class="form-control">
                                <option value="very-low">Very Low</option>
                                <option value="low">Low</option>
                                <option value="medium" selected>Medium</option>
                                <option value="high">High</option>
                                <option value="very-high">Very High</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="daily-mood">Overall Mood</label>
                            <select id="daily-mood" class="form-control">
                                <option value="very-sad">Very Sad</option>
                                <option value="sad">Sad</option>
                                <option value="neutral" selected>Neutral</option>
                                <option value="happy">Happy</option>
                                <option value="very-happy">Very Happy</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="daily-notes">Notes</label>
                            <textarea id="daily-notes" class="form-control" rows="3" placeholder="Any additional notes about today..."></textarea>
                        </div>
                    </div>
                    
                    <div class="data-controls">
                        <button class="btn btn-outline" id="skip-today">
                            Skip Today
                        </button>
                        <button class="btn btn-primary" id="save-daily-log">
                            <i class="fas fa-save"></i> Save Today's Log
                        </button>
                    </div>
                </section>

                <!-- Predictions Section (Visible after setup) -->
                <section class="prediction-section" id="predictions-section" style="display: none;">
                    <div class="prediction-content">
                        <div class="section-header">
                            <h3>Cycle Predictions</h3>
                        </div>
                        <p>Based on your cycle information, here are your predictions for the coming days:</p>
                        
                        <div style="margin: 20px 0;">
                            <div class="cycle-label">Next ovulation predicted on:</div>
                            <div class="prediction-date" id="next-ovulation-date">Calculating...</div>
                        </div>
                        
                        <div style="margin: 20px 0;">
                            <div class="cycle-label">Most fertile days:</div>
                            <div class="prediction-date" id="fertile-window">Calculating...</div>
                        </div>
                        
                        <div style="margin: 20px 0;">
                            <div class="cycle-label">Next period predicted to start:</div>
                            <div class="prediction-date" id="period-prediction">Calculating...</div>
                        </div>
                    </div>
                </section>

                <!-- Data Controls (Visible after setup) -->
                <div class="data-controls" id="tracking-controls" style="display: none;">
                    <button class="btn btn-outline" id="edit-cycle-info">
                        <i class="fas fa-edit"></i> Edit Cycle Info
                    </button>
                    <button class="btn btn-primary" id="save-cycle-data">
                        <i class="fas fa-save"></i> Save All Data
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- Log Period Modal -->
    <div class="modal" id="logPeriodModal">
        <div class="modal-content">
            <div class="section-header">
                <h3>Log Period Start</h3>
                <button class="close-modal" id="closePeriodModal">&times;</button>
            </div>
            <form id="logPeriodForm">
                <div class="form-group">
                    <label for="period-start-date-modal" class="required">Start Date</label>
                    <input type="date" id="period-start-date-modal" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="period-intensity-modal">Intensity</label>
                    <select id="period-intensity-modal" class="form-control" required>
                        <option value="light">Light</option>
                        <option value="medium" selected>Medium</option>
                        <option value="heavy">Heavy</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="period-notes-modal">Notes (optional)</label>
                    <textarea id="period-notes-modal" class="form-control" rows="3" placeholder="Any additional notes..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" id="cancelPeriodBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Log Period</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Symptom Modal -->
    <div class="modal" id="addSymptomModal">
        <div class="modal-content">
            <div class="section-header">
                <h3>Add Symptom</h3>
                <button class="close-modal" id="closeSymptomModal">&times;</button>
            </div>
            <form id="addSymptomForm">
                <div class="form-group">
                    <label for="symptom-type-modal" class="required">Symptom</label>
                    <select id="symptom-type-modal" class="form-control" required>
                        <option value="">Select a symptom</option>
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="symptom-intensity-modal" class="required">Intensity</label>
                    <select id="symptom-intensity-modal" class="form-control" required>
                        <option value="mild">Mild</option>
                        <option value="moderate" selected>Moderate</option>
                        <option value="severe">Severe</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="symptom-notes-modal">Notes (optional)</label>
                    <textarea id="symptom-notes-modal" class="form-control" rows="3" placeholder="Any additional details..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" id="cancelSymptomBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Symptom</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Mood Modal -->
    <div class="modal" id="addMoodModal">
        <div class="modal-content">
            <div class="section-header">
                <h3>Add Mood/Energy</h3>
                <button class="close-modal" id="closeMoodModal">&times;</button>
            </div>
            <form id="addMoodForm">
                <div class="form-group">
                    <label for="mood-type-modal" class="required">Mood/Energy Type</label>
                    <select id="mood-type-modal" class="form-control" required>
                        <option value="">Select mood or energy level</option>
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="mood-intensity-modal">Intensity (Optional)</label>
                    <select id="mood-intensity-modal" class="form-control">
                        <option value="mild">Mild</option>
                        <option value="moderate" selected>Moderate</option>
                        <option value="strong">Strong</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="mood-notes-modal">Notes (optional)</label>
                    <textarea id="mood-notes-modal" class="form-control" rows="3" placeholder="Any additional details..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" id="cancelMoodBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Mood</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Cycle Tracker data model
        const cycleData = {
            // User information
            userInfo: {
                age: null,
                lastPeriodStart: null,
                typicalPeriodLength: null,
                typicalCycleLength: null,
                flowIntensity: "medium",
                contraception: "none",
                pregnancyPlanning: "not-planning",
                regularity: "regular"
            },
            
            // Current cycle state
            currentCycle: {
                day: 1,
                phase: "menstrual",
                startDate: null,
                predictedEndDate: null
            },
            
            // Symptoms and tracking
            selectedSymptoms: [],
            additionalSymptoms: "",
            moodTracking: "daily",
            
            // Daily logs
            dailyLogs: [],
            
            // Predictions
            predictions: {
                nextOvulation: null,
                fertileWindowStart: null,
                fertileWindowEnd: null,
                nextPeriod: null
            },
            
            // Settings
            reminders: true,
            dataSharing: true,
            
            // Track if setup is complete
            setupComplete: false
        };

        // Available symptoms
        const availableSymptoms = [
            { id: "cramps", name: "Cramps", icon: "fas fa-band-aid" },
            { id: "headache", name: "Headache", icon: "fas fa-head-side-virus" },
            { id: "fatigue", name: "Fatigue", icon: "fas fa-bed" },
            { id: "bloating", name: "Bloating", icon: "fas fa-weight" },
            { id: "mood_swings", name: "Mood Swings", icon: "fas fa-cloud-moon" },
            { id: "back_pain", name: "Back Pain", icon: "fas fa-spine" },
            { id: "breast_tenderness", name: "Breast Tenderness", icon: "fas fa-heart" },
            { id: "acne", name: "Acne", icon: "fas fa-allergies" },
            { id: "food_cravings", name: "Food Cravings", icon: "fas fa-cookie-bite" },
            { id: "insomnia", name: "Insomnia", icon: "fas fa-moon" },
            { id: "nausea", name: "Nausea", icon: "fas fa-stomach" },
            { id: "constipation", name: "Constipation", icon: "fas fa-poop" },
            { id: "diarrhea", name: "Diarrhea", icon: "fas fa-toilet" },
            { id: "dizziness", name: "Dizziness", icon: "fas fa-dizzy" }
        ];

        // Available moods
        const availableMoods = [
            { id: "energetic", name: "Energetic", icon: "fas fa-bolt" },
            { id: "happy", name: "Happy", icon: "fas fa-smile" },
            { id: "focused", name: "Focused", icon: "fas fa-brain" },
            { id: "relaxed", name: "Relaxed", icon: "fas fa-spa" },
            { id: "anxious", name: "Anxious", icon: "fas fa-wind" },
            { id: "irritable", name: "Irritable", icon: "fas fa-angry" },
            { id: "sad", name: "Sad", icon: "fas fa-sad-tear" },
            { id: "creative", name: "Creative", icon: "fas fa-palette" },
            { id: "tired", name: "Tired", icon: "fas fa-tired" },
            { id: "stressed", name: "Stressed", icon: "fas fa-heartbeat" }
        ];

        // DOM elements
        // Step navigation
        const step1 = document.getElementById('step1');
        const step2 = document.getElementById('step2');
        const step3 = document.getElementById('step3');
        const step4 = document.getElementById('step4');
        
        // Step content sections
        const step1Content = document.getElementById('step1-content');
        const step2Content = document.getElementById('step2-content');
        const step3Content = document.getElementById('step3-content');
        const step4Content = document.getElementById('step4-content');
        
        // Navigation buttons
        const nextToStep2 = document.getElementById('next-to-step2');
        const backToStep1 = document.getElementById('back-to-step1');
        const nextToStep3 = document.getElementById('next-to-step3');
        const backToStep2 = document.getElementById('back-to-step2');
        const nextToStep4 = document.getElementById('next-to-step4');
        const backToStep3 = document.getElementById('back-to-step3');
        const startTracking = document.getElementById('start-tracking');
        
        // Input fields - Step 1
        const userAgeInput = document.getElementById('user-age');
        const cycleStartDateInput = document.getElementById('cycle-start-date');
        const periodLengthInput = document.getElementById('period-length');
        const cycleLengthInput = document.getElementById('cycle-length');
        
        // Input fields - Step 2
        const flowIntensityInputs = document.querySelectorAll('input[name="flow-intensity"]');
        const contraceptionInput = document.getElementById('contraception');
        const pregnancyPlanningInput = document.getElementById('pregnant-planning');
        const regularityInputs = document.querySelectorAll('input[name="regularity"]');
        
        // Input fields - Step 3
        const symptomsChecklist = document.getElementById('symptoms-checklist');
        const additionalSymptomsInput = document.getElementById('additional-symptoms');
        const moodTrackingInputs = document.querySelectorAll('input[name="mood-tracking"]');
        
        // Step 4 elements
        const reviewSummary = document.getElementById('review-summary');
        const remindersCheckbox = document.getElementById('reminders');
        const dataSharingCheckbox = document.getElementById('data-sharing');
        
        // Cycle overview elements (after setup)
        const cycleOverviewSection = document.getElementById('cycle-overview-section');
        const cycleVisualizationSection = document.getElementById('cycle-visualization-section');
        const dailyLogSection = document.getElementById('daily-log-section');
        const predictionsSection = document.getElementById('predictions-section');
        const trackingControls = document.getElementById('tracking-controls');
        
        // Cycle overview values
        const currentDayEl = document.getElementById('current-day');
        const cycleLengthLabel = document.getElementById('cycle-length-label');
        const cycleLengthValueEl = document.getElementById('cycle-length-value');
        const daysUntilNextEl = document.getElementById('days-until-next');
        const fertilityStatusEl = document.getElementById('fertility-status');
        const fertilityDatesEl = document.getElementById('fertility-dates');
        const nextPeriodDateEl = document.getElementById('next-period-date');
        const currentPhaseEl = document.getElementById('current-phase');
        const cycleChartEl = document.getElementById('cycle-chart');
        const symptomsGridEl = document.getElementById('symptoms-grid');
        const moodGridEl = document.getElementById('mood-grid');
        const nextOvulationDateEl = document.getElementById('next-ovulation-date');
        const fertileWindowEl = document.getElementById('fertile-window');
        const periodPredictionEl = document.getElementById('period-prediction');
        const todayDateEl = document.getElementById('today-date');
        
        // Daily log inputs
        const dailyFlowInput = document.getElementById('daily-flow');
        const dailyEnergyInput = document.getElementById('daily-energy');
        const dailyMoodInput = document.getElementById('daily-mood');
        const dailyNotesInput = document.getElementById('daily-notes');
        
        // Buttons (after setup)
        const logPeriodBtn = document.getElementById('log-period-btn');
        const addSymptomBtn = document.getElementById('add-symptom-btn');
        const addMoodBtn = document.getElementById('add-mood-btn');
        const skipTodayBtn = document.getElementById('skip-today');
        const saveDailyLogBtn = document.getElementById('save-daily-log');
        const editCycleInfoBtn = document.getElementById('edit-cycle-info');
        const saveCycleDataBtn = document.getElementById('save-cycle-data');
        
        // Modals
        const logPeriodModal = document.getElementById('logPeriodModal');
        const addSymptomModal = document.getElementById('addSymptomModal');
        const addMoodModal = document.getElementById('addMoodModal');
        
        // Modal elements
        const periodStartDateModalInput = document.getElementById('period-start-date-modal');
        const symptomTypeModalSelect = document.getElementById('symptom-type-modal');
        const moodTypeModalSelect = document.getElementById('mood-type-modal');

        // Initialize the application
        function initCycleApp() {
            // Set today's date as default in date inputs
            const today = new Date().toISOString().split('T')[0];
            cycleStartDateInput.value = today;
            periodStartDateModalInput.value = today;
            
            // Try to load saved cycle data from localStorage
            const savedCycleData = localStorage.getItem('lifesync-cycle-data');
            
            if (savedCycleData) {
                try {
                    const parsedData = JSON.parse(savedCycleData);
                    Object.assign(cycleData, parsedData);
                    
                    // Check if setup is complete
                    if (cycleData.setupComplete) {
                        // Skip to tracking view
                        showTrackingView();
                        updateCycleUI();
                        showNotification('Cycle data loaded successfully');
                    } else {
                        // Load saved data into form
                        loadSavedDataIntoForm();
                        showNotification('Previous input data loaded');
                    }
                } catch (e) {
                    console.log('Error loading saved cycle data');
                }
            } else {
                // Initialize symptoms checklist
                initializeSymptomsChecklist();
            }
            
            // Set up event listeners
            setupEventListeners();
        }

        // Initialize symptoms checklist
        function initializeSymptomsChecklist() {
            symptomsChecklist.innerHTML = '';
            
            availableSymptoms.forEach(symptom => {
                const checkboxItem = document.createElement('div');
                checkboxItem.className = 'checkbox-item';
                
                checkboxItem.innerHTML = `
                    <input type="checkbox" id="symptom-${symptom.id}" value="${symptom.id}">
                    <label for="symptom-${symptom.id}">${symptom.name}</label>
                `;
                
                symptomsChecklist.appendChild(checkboxItem);
            });
        }

        // Load saved data into form
        function loadSavedDataIntoForm() {
            // Step 1 data
            if (cycleData.userInfo.age) userAgeInput.value = cycleData.userInfo.age;
            if (cycleData.userInfo.lastPeriodStart) cycleStartDateInput.value = cycleData.userInfo.lastPeriodStart;
            if (cycleData.userInfo.typicalPeriodLength) periodLengthInput.value = cycleData.userInfo.typicalPeriodLength;
            if (cycleData.userInfo.typicalCycleLength) cycleLengthInput.value = cycleData.userInfo.typicalCycleLength;
            
            // Step 2 data
            if (cycleData.userInfo.flowIntensity) {
                document.getElementById(`flow-${cycleData.userInfo.flowIntensity}`).checked = true;
            }
            if (cycleData.userInfo.contraception) contraceptionInput.value = cycleData.userInfo.contraception;
            if (cycleData.userInfo.pregnancyPlanning) pregnancyPlanningInput.value = cycleData.userInfo.pregnancyPlanning;
            if (cycleData.userInfo.regularity) {
                document.getElementById(`regular-${cycleData.userInfo.regularity}`).checked = true;
            }
            
            // Step 3 data
            if (cycleData.selectedSymptoms && cycleData.selectedSymptoms.length > 0) {
                cycleData.selectedSymptoms.forEach(symptomId => {
                    const checkbox = document.getElementById(`symptom-${symptomId}`);
                    if (checkbox) checkbox.checked = true;
                });
            }
            if (cycleData.additionalSymptoms) additionalSymptomsInput.value = cycleData.additionalSymptoms;
            if (cycleData.moodTracking) {
                document.getElementById(`mood-${cycleData.moodTracking}`).checked = true;
            }
            
            // Step 4 data
            if (cycleData.reminders !== undefined) remindersCheckbox.checked = cycleData.reminders;
            if (cycleData.dataSharing !== undefined) dataSharingCheckbox.checked = cycleData.dataSharing;
        }

        // Set up event listeners
        function setupEventListeners() {
            // Step navigation
            nextToStep2.addEventListener('click', goToStep2);
            backToStep1.addEventListener('click', goToStep1);
            nextToStep3.addEventListener('click', goToStep3);
            backToStep2.addEventListener('click', goToStep2);
            nextToStep4.addEventListener('click', goToStep4);
            backToStep3.addEventListener('click', goToStep3);
            startTracking.addEventListener('click', completeSetup);
            
            // Daily log buttons
            logPeriodBtn.addEventListener('click', () => logPeriodModal.style.display = 'flex');
            addSymptomBtn.addEventListener('click', () => {
                populateSymptomModal();
                addSymptomModal.style.display = 'flex';
            });
            addMoodBtn.addEventListener('click', () => {
                populateMoodModal();
                addMoodModal.style.display = 'flex';
            });
            skipTodayBtn.addEventListener('click', skipDailyLog);
            saveDailyLogBtn.addEventListener('click', saveDailyLog);
            editCycleInfoBtn.addEventListener('click', editCycleInfo);
            saveCycleDataBtn.addEventListener('click', saveAllData);
            
            // Modal close buttons
            document.getElementById('closePeriodModal').addEventListener('click', () => logPeriodModal.style.display = 'none');
            document.getElementById('closeSymptomModal').addEventListener('click', () => addSymptomModal.style.display = 'none');
            document.getElementById('closeMoodModal').addEventListener('click', () => addMoodModal.style.display = 'none');
            document.getElementById('cancelPeriodBtn').addEventListener('click', () => logPeriodModal.style.display = 'none');
            document.getElementById('cancelSymptomBtn').addEventListener('click', () => addSymptomModal.style.display = 'none');
            document.getElementById('cancelMoodBtn').addEventListener('click', () => addMoodModal.style.display = 'none');
            
            // Modal form submissions
            document.getElementById('logPeriodForm').addEventListener('submit', handleLogPeriod);
            document.getElementById('addSymptomForm').addEventListener('submit', handleAddSymptom);
            document.getElementById('addMoodForm').addEventListener('submit', handleAddMood);
            
            // Close modals when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === logPeriodModal) logPeriodModal.style.display = 'none';
                if (e.target === addSymptomModal) addSymptomModal.style.display = 'none';
                if (e.target === addMoodModal) addMoodModal.style.display = 'none';
            });
        }

        // Step navigation functions
        function goToStep1() {
            saveStep1Data();
            showStep(1);
        }

        function goToStep2() {
            if (!validateStep1()) {
                showNotification('Please fill in all required fields in Step 1');
                return;
            }
            saveStep1Data();
            showStep(2);
        }

        function goToStep3() {
            saveStep2Data();
            showStep(3);
        }

        function goToStep4() {
            saveStep3Data();
            updateReviewSummary();
            showStep(4);
        }

        function showStep(stepNumber) {
            // Hide all step content
            step1Content.style.display = 'none';
            step2Content.style.display = 'none';
            step3Content.style.display = 'none';
            step4Content.style.display = 'none';
            
            // Remove active class from all steps
            step1.classList.remove('active', 'completed');
            step2.classList.remove('active', 'completed');
            step3.classList.remove('active', 'completed');
            step4.classList.remove('active', 'completed');
            
            // Show current step content
            if (stepNumber === 1) {
                step1Content.style.display = 'block';
                step1.classList.add('active');
            } else if (stepNumber === 2) {
                step2Content.style.display = 'block';
                step2.classList.add('active');
                step1.classList.add('completed');
            } else if (stepNumber === 3) {
                step3Content.style.display = 'block';
                step3.classList.add('active');
                step1.classList.add('completed');
                step2.classList.add('completed');
            } else if (stepNumber === 4) {
                step4Content.style.display = 'block';
                step4.classList.add('active');
                step1.classList.add('completed');
                step2.classList.add('completed');
                step3.classList.add('completed');
            }
        }

        // Validate Step 1 data
        function validateStep1() {
            if (!userAgeInput.value || userAgeInput.value < 13 || userAgeInput.value > 60) {
                return false;
            }
            if (!cycleStartDateInput.value) {
                return false;
            }
            if (!periodLengthInput.value || periodLengthInput.value < 1 || periodLengthInput.value > 14) {
                return false;
            }
            if (!cycleLengthInput.value || cycleLengthInput.value < 21 || cycleLengthInput.value > 45) {
                return false;
            }
            return true;
        }

        // Save Step 1 data
        function saveStep1Data() {
            cycleData.userInfo.age = parseInt(userAgeInput.value);
            cycleData.userInfo.lastPeriodStart = cycleStartDateInput.value;
            cycleData.userInfo.typicalPeriodLength = parseInt(periodLengthInput.value);
            cycleData.userInfo.typicalCycleLength = parseInt(cycleLengthInput.value);
        }

        // Save Step 2 data
        function saveStep2Data() {
            // Flow intensity
            flowIntensityInputs.forEach(input => {
                if (input.checked) {
                    cycleData.userInfo.flowIntensity = input.value;
                }
            });
            
            // Contraception
            cycleData.userInfo.contraception = contraceptionInput.value;
            
            // Pregnancy planning
            cycleData.userInfo.pregnancyPlanning = pregnancyPlanningInput.value;
            
            // Regularity
            regularityInputs.forEach(input => {
                if (input.checked) {
                    cycleData.userInfo.regularity = input.value;
                }
            });
        }

        // Save Step 3 data
        function saveStep3Data() {
            // Selected symptoms
            cycleData.selectedSymptoms = [];
            const symptomCheckboxes = symptomsChecklist.querySelectorAll('input[type="checkbox"]');
            symptomCheckboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    cycleData.selectedSymptoms.push(checkbox.value);
                }
            });
            
            // Additional symptoms
            cycleData.additionalSymptoms = additionalSymptomsInput.value;
            
            // Mood tracking preference
            moodTrackingInputs.forEach(input => {
                if (input.checked) {
                    cycleData.moodTracking = input.value;
                }
            });
        }

        // Update review summary
        function updateReviewSummary() {
            reviewSummary.innerHTML = '';
            
            // Create summary cards
            const summaries = [
                {
                    title: 'Basic Info',
                    items: [
                        `Age: ${cycleData.userInfo.age}`,
                        `Last Period: ${formatDate(cycleData.userInfo.lastPeriodStart)}`,
                        `Period Length: ${cycleData.userInfo.typicalPeriodLength} days`,
                        `Cycle Length: ${cycleData.userInfo.typicalCycleLength} days`
                    ]
                },
                {
                    title: 'Cycle Details',
                    items: [
                        `Flow: ${cycleData.userInfo.flowIntensity}`,
                        `Contraception: ${cycleData.userInfo.contraception}`,
                        `Planning: ${cycleData.userInfo.pregnancyPlanning.replace('-', ' ')}`,
                        `Regularity: ${cycleData.userInfo.regularity}`
                    ]
                },
                {
                    title: 'Symptoms',
                    items: [
                        `Selected Symptoms: ${cycleData.selectedSymptoms.length}`,
                        `Mood Tracking: ${cycleData.moodTracking}`,
                        cycleData.additionalSymptoms ? 'Additional notes provided' : 'No additional notes'
                    ]
                }
            ];
            
            summaries.forEach(summary => {
                const summaryCard = document.createElement('div');
                summaryCard.className = 'cycle-card';
                
                let itemsHtml = '';
                summary.items.forEach(item => {
                    itemsHtml += `<div class="cycle-label">${item}</div>`;
                });
                
                summaryCard.innerHTML = `
                    <div class="cycle-header">
                        <h3>${summary.title}</h3>
                        <i class="fas fa-info-circle"></i>
                    </div>
                    ${itemsHtml}
                `;
                
                reviewSummary.appendChild(summaryCard);
            });
        }

        // Complete setup and show tracking view
        function completeSetup() {
            // Save Step 4 data
            cycleData.reminders = remindersCheckbox.checked;
            cycleData.dataSharing = dataSharingCheckbox.checked;
            
            // Mark setup as complete
            cycleData.setupComplete = true;
            
            // Initialize current cycle
            initializeCurrentCycle();
            
            // Calculate predictions
            calculatePredictions();
            
            // Save data
            saveAllData();
            
            // Show tracking view
            showTrackingView();
            
            // Update UI
            updateCycleUI();
            
            showNotification('Cycle tracking started successfully!');
        }

        // Initialize current cycle
        function initializeCurrentCycle() {
            const lastPeriodStart = new Date(cycleData.userInfo.lastPeriodStart);
            const today = new Date();
            
            // Calculate current day of cycle
            const timeDiff = today.getTime() - lastPeriodStart.getTime();
            const dayDiff = Math.floor(timeDiff / (1000 * 3600 * 24)) + 1;
            
            // Ensure day is within cycle length
            cycleData.currentCycle.day = Math.min(dayDiff, cycleData.userInfo.typicalCycleLength);
            
            // Set phase based on day
            if (cycleData.currentCycle.day <= cycleData.userInfo.typicalPeriodLength) {
                cycleData.currentCycle.phase = "menstrual";
            } else if (cycleData.currentCycle.day <= 14) {
                cycleData.currentCycle.phase = "follicular";
            } else if (cycleData.currentCycle.day <= 16) {
                cycleData.currentCycle.phase = "ovulation";
            } else {
                cycleData.currentCycle.phase = "luteal";
            }
            
            // Set start date
            cycleData.currentCycle.startDate = cycleData.userInfo.lastPeriodStart;
            
            // Calculate predicted end date
            const predictedEnd = new Date(lastPeriodStart);
            predictedEnd.setDate(predictedEnd.getDate() + cycleData.userInfo.typicalCycleLength);
            cycleData.currentCycle.predictedEndDate = predictedEnd.toISOString().split('T')[0];
        }

        // Calculate predictions
        function calculatePredictions() {
            const lastPeriodStart = new Date(cycleData.userInfo.lastPeriodStart);
            const cycleLength = cycleData.userInfo.typicalCycleLength;
            
            // Next period
            const nextPeriod = new Date(lastPeriodStart);
            nextPeriod.setDate(nextPeriod.getDate() + cycleLength);
            cycleData.predictions.nextPeriod = nextPeriod.toISOString().split('T')[0];
            
            // Next ovulation (approx 14 days before next period)
            const nextOvulation = new Date(nextPeriod);
            nextOvulation.setDate(nextOvulation.getDate() - 14);
            cycleData.predictions.nextOvulation = nextOvulation.toISOString().split('T')[0];
            
            // Fertile window (5 days before ovulation to 1 day after)
            const fertileStart = new Date(nextOvulation);
            fertileStart.setDate(fertileStart.getDate() - 5);
            cycleData.predictions.fertileWindowStart = fertileStart.toISOString().split('T')[0];
            
            const fertileEnd = new Date(nextOvulation);
            fertileEnd.setDate(fertileEnd.getDate() + 1);
            cycleData.predictions.fertileWindowEnd = fertileEnd.toISOString().split('T')[0];
        }

        // Show tracking view (after setup)
        function showTrackingView() {
            // Hide setup steps
            step1Content.style.display = 'none';
            step2Content.style.display = 'none';
            step3Content.style.display = 'none';
            step4Content.style.display = 'none';
            
            // Show tracking sections
            cycleOverviewSection.style.display = 'block';
            cycleVisualizationSection.style.display = 'block';
            dailyLogSection.style.display = 'block';
            predictionsSection.style.display = 'block';
            trackingControls.style.display = 'flex';
            
            // Update today's date
            const today = new Date();
            todayDateEl.textContent = `Today: ${formatDate(today.toISOString().split('T')[0])}`;
        }

        // Update cycle UI
        function updateCycleUI() {
            if (!cycleData.setupComplete) return;
            
            // Update overview cards
            currentDayEl.textContent = `Day ${cycleData.currentCycle.day}`;
            cycleLengthLabel.textContent = `of ${cycleData.userInfo.typicalCycleLength}-day cycle`;
            cycleLengthValueEl.textContent = cycleData.userInfo.typicalCycleLength;
            
            // Calculate days until next period
            const nextPeriodDate = new Date(cycleData.predictions.nextPeriod);
            const today = new Date();
            const timeDiff = nextPeriodDate.getTime() - today.getTime();
            const daysUntilNext = Math.ceil(timeDiff / (1000 * 3600 * 24));
            daysUntilNextEl.textContent = `${daysUntilNext} days`;
            
            // Update fertility info
            updateFertilityInfo();
            
            // Update next period date
            const nextPeriodFormatted = formatDateShort(cycleData.predictions.nextPeriod);
            nextPeriodDateEl.textContent = nextPeriodFormatted;
            
            // Update current phase
            updateCurrentPhase();
            
            // Update cycle chart
            updateCycleChart();
            
            // Update symptoms
            updateSymptomsUI();
            
            // Update mood
            updateMoodUI();
            
            // Update predictions
            updatePredictionsUI();
        }

        // Update fertility information
        function updateFertilityInfo() {
            let fertilityStatus = "Low";
            
            if (cycleData.currentCycle.day >= 10 && cycleData.currentCycle.day <= 17) {
                fertilityStatus = "High";
            } else if (cycleData.currentCycle.day >= 8 && cycleData.currentCycle.day <= 19) {
                fertilityStatus = "Medium";
            }
            
            fertilityStatusEl.textContent = fertilityStatus;
            
            // Calculate fertility dates
            const lastPeriod = new Date(cycleData.userInfo.lastPeriodStart);
            const fertileStart = new Date(lastPeriod);
            fertileStart.setDate(lastPeriod.getDate() + 10);
            
            const fertileEnd = new Date(lastPeriod);
            fertileEnd.setDate(lastPeriod.getDate() + 17);
            
            const fertileStartStr = formatDateShort(fertileStart.toISOString().split('T')[0]);
            const fertileEndStr = formatDateShort(fertileEnd.toISOString().split('T')[0]);
            
            fertilityDatesEl.textContent = `${fertileStartStr} - ${fertileEndStr}`;
        }

        // Update current phase
        function updateCurrentPhase() {
            let phase = "Follicular";
            let phaseClass = "phase-follicular";
            
            if (cycleData.currentCycle.phase === "menstrual") {
                phase = "Menstrual";
                phaseClass = "phase-menstrual";
            } else if (cycleData.currentCycle.phase === "ovulation") {
                phase = "Ovulation";
                phaseClass = "phase-ovulation";
            } else if (cycleData.currentCycle.phase === "luteal") {
                phase = "Luteal";
                phaseClass = "phase-luteal";
            }
            
            currentPhaseEl.textContent = phase;
            currentPhaseEl.className = `cycle-phase ${phaseClass}`;
        }

        // Update cycle chart
        function updateCycleChart() {
            cycleChartEl.innerHTML = '';
            const cycleLength = cycleData.userInfo.typicalCycleLength;
            
            for (let day = 1; day <= cycleLength; day++) {
                const chartDay = document.createElement('div');
                chartDay.className = 'chart-day';
                
                // Determine phase for color
                let color = "#4cc9f0"; // Follicular default
                if (day <= cycleData.userInfo.typicalPeriodLength) {
                    color = "#ff5252"; // Menstrual
                } else if (day >= 14 && day <= 16) {
                    color = "#ff5a8c"; // Ovulation
                } else if (day > 16) {
                    color = "#ff9ebf"; // Luteal
                }
                
                // Calculate height based on day
                let height = 30;
                if (day <= cycleData.userInfo.typicalPeriodLength) {
                    height = 40 + (day * 5);
                } else if (day >= 10 && day <= 14) {
                    height = 70 + ((day - 10) * 10);
                } else if (day >= 15) {
                    height = 80 - ((day - 15) * 3);
                }
                
                // Set styles
                chartDay.style.backgroundColor = color;
                chartDay.style.height = `${height}%`;
                chartDay.style.setProperty('--chart-height', `${height}%`);
                chartDay.style.animationDelay = `${day * 0.05}s`;
                
                // Mark today
                if (day === cycleData.currentCycle.day) {
                    chartDay.classList.add('chart-day-today');
                    chartDay.title = `Today: Day ${day}`;
                } else {
                    chartDay.title = `Day ${day}`;
                }
                
                // Add label for every 5th day
                const label = document.createElement('div');
                label.className = 'chart-day-label';
                label.textContent = day % 5 === 0 ? `Day ${day}` : '';
                
                chartDay.appendChild(label);
                cycleChartEl.appendChild(chartDay);
            }
        }

        // Update symptoms UI
        function updateSymptomsUI() {
            symptomsGridEl.innerHTML = '';
            
            // Get today's logged symptoms from daily logs
            const today = new Date().toISOString().split('T')[0];
            const todayLog = cycleData.dailyLogs.find(log => log.date === today);
            const todaysSymptoms = todayLog ? todayLog.symptoms || [] : [];
            
            if (todaysSymptoms.length === 0) {
                const emptyMsg = document.createElement('div');
                emptyMsg.className = 'symptom-item';
                emptyMsg.innerHTML = '<p>No symptoms logged today.</p>';
                symptomsGridEl.appendChild(emptyMsg);
            } else {
                todaysSymptoms.forEach((symptom, index) => {
                    const symptomItem = document.createElement('div');
                    symptomItem.className = 'symptom-item active';
                    symptomItem.style.animationDelay = `${index * 0.1}s`;
                    
                    const symptomInfo = availableSymptoms.find(s => s.id === symptom.type);
                    
                    symptomItem.innerHTML = `
                        <div class="symptom-icon">
                            <i class="${symptomInfo ? symptomInfo.icon : 'fas fa-heartbeat'}"></i>
                        </div>
                        <div class="symptom-name">${symptomInfo ? symptomInfo.name : symptom.type}</div>
                        <div style="font-size: 12px; color: var(--gray); margin-top: 5px;">${symptom.intensity}</div>
                    `;
                    
                    symptomsGridEl.appendChild(symptomItem);
                });
            }
        }

        // Update mood UI
        function updateMoodUI() {
            moodGridEl.innerHTML = '';
            
            // Get today's logged moods from daily logs
            const today = new Date().toISOString().split('T')[0];
            const todayLog = cycleData.dailyLogs.find(log => log.date === today);
            const todaysMoods = todayLog ? todayLog.moods || [] : [];
            
            if (todaysMoods.length === 0) {
                const emptyMsg = document.createElement('div');
                emptyMsg.className = 'symptom-item';
                emptyMsg.innerHTML = '<p>No mood logged today.</p>';
                moodGridEl.appendChild(emptyMsg);
            } else {
                todaysMoods.forEach((mood, index) => {
                    const moodItem = document.createElement('div');
                    moodItem.className = 'symptom-item active';
                    moodItem.style.animationDelay = `${index * 0.1}s`;
                    
                    const moodInfo = availableMoods.find(m => m.id === mood.type);
                    
                    moodItem.innerHTML = `
                        <div class="symptom-icon">
                            <i class="${moodInfo ? moodInfo.icon : 'fas fa-smile'}"></i>
                        </div>
                        <div class="symptom-name">${moodInfo ? moodInfo.name : mood.type}</div>
                    `;
                    
                    moodGridEl.appendChild(moodItem);
                });
            }
        }

        // Update predictions UI
        function updatePredictionsUI() {
            nextOvulationDateEl.textContent = formatDate(cycleData.predictions.nextOvulation);
            
            const fertileStart = formatDate(cycleData.predictions.fertileWindowStart);
            const fertileEnd = formatDate(cycleData.predictions.fertileWindowEnd);
            fertileWindowEl.textContent = `${fertileStart} - ${fertileEnd}`;
            
            periodPredictionEl.textContent = formatDate(cycleData.predictions.nextPeriod);
        }

        // Populate symptom modal
        function populateSymptomModal() {
            symptomTypeModalSelect.innerHTML = '<option value="">Select a symptom</option>';
            
            availableSymptoms.forEach(symptom => {
                const option = document.createElement('option');
                option.value = symptom.id;
                option.textContent = symptom.name;
                symptomTypeModalSelect.appendChild(option);
            });
        }

        // Populate mood modal
        function populateMoodModal() {
            moodTypeModalSelect.innerHTML = '<option value="">Select mood or energy level</option>';
            
            availableMoods.forEach(mood => {
                const option = document.createElement('option');
                option.value = mood.id;
                option.textContent = mood.name;
                moodTypeModalSelect.appendChild(option);
            });
        }

        // Handle log period form submission
        function handleLogPeriod(e) {
            e.preventDefault();
            
            const startDate = document.getElementById('period-start-date-modal').value;
            const intensity = document.getElementById('period-intensity-modal').value;
            const notes = document.getElementById('period-notes-modal').value;
            
            // Update last period start
            cycleData.userInfo.lastPeriodStart = startDate;
            
            // Reset current day to 1
            cycleData.currentCycle.day = 1;
            cycleData.currentCycle.phase = "menstrual";
            cycleData.currentCycle.startDate = startDate;
            
            // Recalculate predictions
            calculatePredictions();
            
            // Update UI
            updateCycleUI();
            logPeriodModal.style.display = 'none';
            
            // Reset form
            e.target.reset();
            periodStartDateModalInput.value = new Date().toISOString().split('T')[0];
            
            showNotification('Period logged successfully. Cycle reset to Day 1.');
        }

        // Handle add symptom form submission
        function handleAddSymptom(e) {
            e.preventDefault();
            
            const type = document.getElementById('symptom-type-modal').value;
            const intensity = document.getElementById('symptom-intensity-modal').value;
            const notes = document.getElementById('symptom-notes-modal').value;
            
            if (!type) {
                showNotification('Please select a symptom');
                return;
            }
            
            const today = new Date().toISOString().split('T')[0];
            
            // Find or create today's log
            let todayLog = cycleData.dailyLogs.find(log => log.date === today);
            if (!todayLog) {
                todayLog = {
                    date: today,
                    symptoms: [],
                    moods: [],
                    flow: 'none',
                    energy: 'medium',
                    mood: 'neutral',
                    notes: ''
                };
                cycleData.dailyLogs.push(todayLog);
            }
            
            // Add symptom
            todayLog.symptoms.push({
                type,
                intensity,
                notes: notes || ''
            });
            
            // Update UI
            updateSymptomsUI();
            addSymptomModal.style.display = 'none';
            
            // Reset form
            e.target.reset();
            
            showNotification('Symptom added successfully');
        }

        // Handle add mood form submission
        function handleAddMood(e) {
            e.preventDefault();
            
            const type = document.getElementById('mood-type-modal').value;
            const intensity = document.getElementById('mood-intensity-modal').value;
            const notes = document.getElementById('mood-notes-modal').value;
            
            if (!type) {
                showNotification('Please select a mood or energy level');
                return;
            }
            
            const today = new Date().toISOString().split('T')[0];
            
            // Find or create today's log
            let todayLog = cycleData.dailyLogs.find(log => log.date === today);
            if (!todayLog) {
                todayLog = {
                    date: today,
                    symptoms: [],
                    moods: [],
                    flow: 'none',
                    energy: 'medium',
                    mood: 'neutral',
                    notes: ''
                };
                cycleData.dailyLogs.push(todayLog);
            }
            
            // Add mood
            todayLog.moods.push({
                type,
                intensity: intensity || 'moderate',
                notes: notes || ''
            });
            
            // Update UI
            updateMoodUI();
            addMoodModal.style.display = 'none';
            
            // Reset form
            e.target.reset();
            
            showNotification('Mood/energy added successfully');
        }

        // Skip daily log
        function skipDailyLog() {
            showNotification('Daily log skipped. You can log again tomorrow.');
        }

        // Save daily log
        function saveDailyLog() {
            const today = new Date().toISOString().split('T')[0];
            
            // Find or create today's log
            let todayLog = cycleData.dailyLogs.find(log => log.date === today);
            if (!todayLog) {
                todayLog = {
                    date: today,
                    symptoms: [],
                    moods: [],
                    flow: 'none',
                    energy: 'medium',
                    mood: 'neutral',
                    notes: ''
                };
                cycleData.dailyLogs.push(todayLog);
            }
            
            // Update log with form values
            todayLog.flow = dailyFlowInput.value;
            todayLog.energy = dailyEnergyInput.value;
            todayLog.mood = dailyMoodInput.value;
            todayLog.notes = dailyNotesInput.value;
            
            // Save data
            saveAllData();
            
            // Reset form
            dailyFlowInput.value = 'none';
            dailyEnergyInput.value = 'medium';
            dailyMoodInput.value = 'neutral';
            dailyNotesInput.value = '';
            
            showNotification('Daily log saved successfully');
        }

        // Edit cycle info
        function editCycleInfo() {
            // Go back to setup
            cycleData.setupComplete = false;
            showStep(1);
            
            // Hide tracking sections
            cycleOverviewSection.style.display = 'none';
            cycleVisualizationSection.style.display = 'none';
            dailyLogSection.style.display = 'none';
            predictionsSection.style.display = 'none';
            trackingControls.style.display = 'none';
            
            showNotification('You can now edit your cycle information');
        }

        // Save all data to localStorage
        function saveAllData() {
            localStorage.setItem('lifesync-cycle-data', JSON.stringify(cycleData));
            showNotification('All cycle data saved successfully');
        }

        // Format date to readable string
        function formatDate(dateString) {
            if (!dateString) return "Not set";
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { 
                month: 'long', 
                day: 'numeric', 
                year: 'numeric' 
            });
        }

        // Format date to short string (Month Day)
        function formatDateShort(dateString) {
            if (!dateString) return "Not set";
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { 
                month: 'short', 
                day: 'numeric'
            });
        }

        // Show a temporary notification
        function showNotification(message) {
            // Remove existing notification if any
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) {
                existingNotification.remove();
            }
            
            // Create notification element
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            
            // Add to page
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Initialize the cycle app when DOM is loaded
        document.addEventListener('DOMContentLoaded', initCycleApp);
    </script>
</body>
</html>